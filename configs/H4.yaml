# H2 Bilateral Detection Configuration
# Training-time data augmentation with vertical flip for bilateral toepad detection
# Based on H1.yaml with added augmentation parameters

preprocessing:
  image-dir: /storage/ice-shared/cs8903onl/miami_fall_24_jpgs
  tps-dir: /storage/ice-shared/cs8903onl/tps_files
  output-dir: data/final_processed_id_bilateral
  target-size: 1280
  point-size: 10
  add-points: true
  num-workers: 8

split:
  images-dir: data/final_processed_id_bilateral/images
  labels-dir: data/final_processed_id_bilateral/labels
  output-dir: data/dataset
  train-ratio: 0.8
  seed: 42
  copy: false
  exts: .jpg,.jpeg,.png

train:
  # Dataset configuration
  data: null # Use dataset section below instead

  # Model configuration
  model: models/base_models/yolov11s.pt

  # Training parameters
  epochs: 300
  batch: 32
  imgsz: 1280
  workers: 2
  patience: 50
  name: H3
  device: 0 # Use GPU 0, set to 'cpu' if no GPU
  amp: true
  cache: false
  save_period: 10

  # ========================================
  # Data Augmentation Parameters
  # ========================================

  # Conservative geometric augmentations
  degrees: 8.0 # Slight rotation Â±5 degrees
  translate: 0.1 # Slight translation 5% of image size
  scale: 0.3 # Slight scale variation (0.8x to 1.2x range)
  shear: 0.0 # No shearing (keep specimens anatomically correct)
  perspective: 0.0 # No perspective transform

  # Color augmentations (YOLO defaults, good for grayscale specimens)
  hsv_h: 0.015 # Hue variation (minimal effect on grayscale)
  hsv_s: 0.7 # Saturation variation
  hsv_v: 0.4 # Value/brightness variation

  # Mosaic augmentation
  mosaic: 1.0 # Keep mosaic augmentation (default, helps with multi-object detection)

  # Advanced augmentations
  fliplr: 0.5      # Horizontal flip (50% probability)
  mixup: 0.1       # Mixup augmentation
  copy_paste: 0.1  # Copy-paste augmentation

  # Training strategies
  cos_lr: true     # Cosine learning rate scheduler
  close_mosaic: 10 # Disable mosaic for the last 10 epochs

dataset:
  # Dataset paths
  path: data/dataset
  train: images/train
  val: images/val
  # Optional test split
  # test: images/test

  # Class configuration
  nc: 6
  names: ["up_finger", "up_toe", "bot_finger", "bot_toe", "ruler", "id"]

inference:
  conf: 0.2 # Confidence threshold (0-1)
  iou: 0.2 # IoU threshold for NMS (0-1)
  imgsz: 1024 # Image size for inference
  save: true # Save results
  save_txt: false # Save results as txt files
  project: results # Results save directory
