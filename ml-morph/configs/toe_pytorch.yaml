# PyTorch Keypoint Training Config for Toe

# Preprocessing stage (converts TPS to XML)
preprocessing:
  tps_file: consolidated_toe.tps
  image_dir: train
  train_ratio: 0.8
  output_train: train.xml
  output_test: test.xml

# Data loading stage
data:
  root: .
  train_xml: train.xml
  val_xml: test.xml
  image_size: 256
  num_workers: 4
  augment: true
  persistent_workers: true  # Keep workers alive between epochs for faster loading

model:
  # num_keypoints is auto-detected from data
  pretrained: true
  lr: 0.0001  # Learning rate
  weight_decay: 0.0001  # Weight decay for regularization
  # freeze_backbone_until: 5  # Optional: freeze first N layers

trainer:
  batch_size: 16
  max_epochs: 50
  accelerator: auto  # Will use MPS on Mac, CUDA on GPU, CPU otherwise
  devices: auto
  precision: "32"  # Use "16-mixed" for GPU
  default_root_dir: runs/keypoints/toe
  pin_memory: true
